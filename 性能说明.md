# 抓取性能说明

## ⚡ 性能对比

### 只获取 URL（不包含发布时间）
- **速度**: 极快（约 8-10 秒抓取 300 条）
- **方式**: 使用 `extract_flat='in_playlist'` 模式
- **原理**: 只获取播放列表结构，不处理单个视频
- **API 调用**: 约 10-20 次（分页获取播放列表）

### 获取 URL + 发布时间
- **速度**: 较慢（约 5-15 分钟抓取 155 条）
- **方式**: 使用 `extract_flat=False` + `process=True` 模式
- **原理**: 必须处理每个视频才能获取发布时间
- **API 调用**: 每个视频约 2-4 次 API 调用
  - 155 个视频 × 3 次 = 约 465 次 API 调用

## 🐌 为什么获取发布时间会慢？

### 技术原因

1. **必须处理每个视频**
   - YouTube 的播放列表 API 不包含每个视频的发布时间
   - 必须访问每个视频的详情页面才能获取发布时间

2. **多次 API 调用**
   - 每个视频需要调用多个 API：
     - Initial Data API
     - Android Player API
     - Web Player API（如果使用）
   - 网络延迟累加

3. **YouTube 限制**
   - YouTube 有速率限制
   - 频繁请求可能触发限流

### 实际耗时示例

| 视频数量 | 预计耗时 | 说明 |
|---------|---------|------|
| 50 条 | 1-3 分钟 | 较快 |
| 100 条 | 3-6 分钟 | 中等 |
| 155 条 | 5-15 分钟 | 较慢 |
| 300 条 | 10-30 分钟 | 很慢 |

## 🚀 优化措施

### 已实施的优化

1. **只使用一个客户端**
   - 从 `['android', 'web']` 改为 `['android']`
   - 减少 50% 的 API 调用

2. **跳过不必要的解析**
   - `player_skip: ['webpage', 'configs', 'iframe']`
   - 减少处理时间

3. **不下载视频**
   - `skip_download: True`
   - 只获取元数据

### 进一步优化建议

如果仍然太慢，可以考虑：

1. **分批处理**
   - 将大量视频分成多个批次
   - 每批 50-100 个视频

2. **异步处理**
   - 使用多线程/异步请求
   - 注意 YouTube 的速率限制

3. **缓存机制**
   - 如果重复抓取同一频道
   - 可以缓存已获取的日期信息

## 💡 使用建议

### 场景 1：只需要 URL
- **推荐**: 使用 `include_date=False`
- **速度**: 极快（8-10 秒）

### 场景 2：需要 URL + 发布时间
- **推荐**: 使用 `include_date=True`
- **速度**: 较慢（5-15 分钟）
- **建议**: 
  - 在非高峰时段运行
  - 如果频道视频很多，考虑分批处理
  - 可以先用快速模式获取 URL，再单独获取日期

## 📊 本次抓取分析

**Dan Koe 频道抓取**:
- 视频数量: 155 条
- 耗时: 约 15 分钟
- API 调用: 约 465 次（155 × 3）
- 结果: ✅ 成功获取所有视频的 URL 和发布时间

**卡点总结**:
1. ✅ 必须处理每个视频（无法避免）
2. ✅ 多次 API 调用（已优化为单客户端）
3. ✅ 网络延迟累加（正常现象）

## 🔧 如果遇到超时

如果抓取过程中断或超时：

1. **检查网络连接**
2. **降低抓取数量**（修改 `max_videos`）
3. **使用快速模式**（`include_date=False`）先获取 URL
4. **分批处理**：修改代码支持断点续传

